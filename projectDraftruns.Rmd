---
title: "ICT371"
author: "Elizabeth Permina"
date: "5/20/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(lubridate)
library(openxlsx)
library(readxl)
```

## readxl

col_types = c("text", "text",	"date",	"text",	"text",	"numeric",	"numeric",	"numeric",	"numeric",	"numeric", "numeric",	"numeric",	"numeric")
```{r}

xlsxFile<-"20210503_Westpac_Merchant_Statements_332259464_00000_1_23772.xlsx"
a<- read_excel(xlsxFile, sheet = 1, col_names = TRUE, skip = 8, trim_ws = TRUE)
transaction_id<-c("TDESD")
```

```{r}
head(a)
```

Note that something strange is going on in the row 2 (Sales Amount, etc), but it is consistent result for both openxlsx::read.xls and  readxl::read_excel. There are similar rows downstream as well. We might use round(x, digits = 2), just have to check that it does not change cents amount and create discrepancy in the total sums

## openxlsx
```{r}
xlsxFile<-"20210503_Westpac_Merchant_Statements_332259464_00000_1_23772.xlsx"
b<-read.xlsx(xlsxFile, sheet = 1, startRow = 9, cols = c(1:10), na.strings = "NA", colNames = TRUE, skipEmptyCols = TRUE, detectDates = TRUE)
b$Date<-convertToDate(b$Date)
```

with convertToDate() dates entered in the format "12/4/2021" would have been read in correctly, those that are "13/04" are turned into NAs. Different formats are an artifact created by Excel in attempt to americanise the date format (it believes that first two digits are a month number and things go strange starting from the 13th day of each month)

```{r}
head(b)
```

```{r}
b[12:15,]
```


## Stdin

you would have to type in the file name in the console pane:

![console  pane ](images/stdin.png)




```{r}
cat("What's your file name? ")
x <- readLines(con=stdin(),1)
print(x)
```


## Sample data

Read in:
```{r}
data<-read.csv("sample_file2.csv", header = T)
```

Some data wrangling:

```{r}
data$Quantity<-sample(0:25, nrow(data), replace = TRUE)
data$Total.Charge<-data$Quantity * data$Full.cost.unit
data_sort_by_unit_price<-data[order(data$Unit.Price.Charged),]
```


Simple plot:

```{r}
d<-data_sort_by_unit_price
plot(d$Unit.Price.Charged, d$Quantity, pch = 15, col = "red", main = "Number of kits Puchased", ylab = "Quantity", xlab = "Price per unit")
```

